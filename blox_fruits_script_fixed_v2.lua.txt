-- Blox Fruits Auto Farm Script
-- Made by xX_ProGamer_Xx for my crew
-- Works on all seas, tested on Sea 1 & 2

local player = game.Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local humanoid = char:WaitForChild("Humanoid")
local rootpart = char:WaitForChild("HumanoidRootPart")

-- Services
local rs = game:GetService("RunService")
local ts = game:GetService("TweenService")
local vu = game:GetService("VirtualUser")
local rep = game:GetService("ReplicatedStorage")

-- Anti-AFK
player.Idled:Connect(function()
    vu:Button2Down(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
    wait(1)
    vu:Button2Up(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
end)

-- Settings you can change
local Settings = {
    AutoFarm = true,
    AutoQuest = true,
    BringMobs = true,
    AttackSpeed = 0.1,
    TweenSpeed = 300,
    DistanceFromMob = 20
}

-- Current quest info
local QuestData = {
    QuestName = "",
    QuestNum = 1,
    MonsterName = "",
    QuestGiver = CFrame.new(0,0,0),
    MonsterSpawn = CFrame.new(0,0,0)
}

-- Check what level and set quest accordingly
local function getQuest()
    local level = player.Data.Level.Value
    
    if level >= 1 and level <= 9 then
        QuestData.MonsterName = "Bandit"
        QuestData.QuestName = "BanditQuest1"
        QuestData.QuestNum = 1
        QuestData.QuestGiver = CFrame.new(1060.93835, 16.4550667, 1547.78418)
        QuestData.MonsterSpawn = CFrame.new(1145, 17, 1634)
    elseif level >= 10 and level <= 14 then
        QuestData.MonsterName = "Monkey"
        QuestData.QuestName = "JungleQuest" 
        QuestData.QuestNum = 1
        QuestData.QuestGiver = CFrame.new(-1598.08911, 35.5501175, 153.377838)
        QuestData.MonsterSpawn = CFrame.new(-1448, 50, 63)
    elseif level >= 15 and level <= 29 then
        QuestData.MonsterName = "Gorilla"
        QuestData.QuestName = "JungleQuest"
        QuestData.QuestNum = 2  
        QuestData.QuestGiver = CFrame.new(-1598.08911, 35.5501175, 153.377838)
        QuestData.MonsterSpawn = CFrame.new(-1129, 40, -515)
    elseif level >= 30 and level <= 39 then
        QuestData.MonsterName = "Pirate"
        QuestData.QuestName = "BuggyQuest1"
        QuestData.QuestNum = 1
        QuestData.QuestGiver = CFrame.new(-1140.27002, 4.75205183, 3827.5498)  
        QuestData.MonsterSpawn = CFrame.new(-1201, 40, 3857)
    elseif level >= 40 and level <= 59 then
        QuestData.MonsterName = "Brute"
        QuestData.QuestName = "BuggyQuest1"
        QuestData.QuestNum = 2
        QuestData.QuestGiver = CFrame.new(-1140.27002, 4.75205183, 3827.5498)
        QuestData.MonsterSpawn = CFrame.new(-1387, 87, 4100)
    elseif level >= 60 and level <= 74 then
        QuestData.MonsterName = "Desert Bandit"
        QuestData.QuestName = "DesertQuest"
        QuestData.QuestNum = 1
        QuestData.QuestGiver = CFrame.new(894.488647, 5.14000702, 4392.43359)
        QuestData.MonsterSpawn = CFrame.new(932, 7, 4484)
    elseif level >= 75 and level <= 89 then
        QuestData.MonsterName = "Desert Officer"
        QuestData.QuestName = "DesertQuest"
        QuestData.QuestNum = 2
        QuestData.QuestGiver = CFrame.new(894.488647, 5.14000702, 4392.43359)
        QuestData.MonsterSpawn = CFrame.new(1608, 8, 4371)
    elseif level >= 90 and level <= 99 then
        QuestData.MonsterName = "Snow Bandit"
        QuestData.QuestName = "SnowQuest"
        QuestData.QuestNum = 1
        QuestData.QuestGiver = CFrame.new(1389.74451, 88.1519318, -1298.90796)
        QuestData.MonsterSpawn = CFrame.new(1354, 87, -1393)
    elseif level >= 100 and level <= 119 then
        QuestData.MonsterName = "Snowman"
        QuestData.QuestName = "SnowQuest"
        QuestData.QuestNum = 2
        QuestData.QuestGiver = CFrame.new(1389.74451, 88.1519318, -1298.90796)
        QuestData.MonsterSpawn = CFrame.new(1201, 400, -1404)
    elseif level >= 120 and level <= 149 then
        QuestData.MonsterName = "Chief Petty Officer"
        QuestData.QuestName = "MarineQuest2"
        QuestData.QuestNum = 1
        QuestData.QuestGiver = CFrame.new(-5039.58643, 27.3500385, 4324.68018)
        QuestData.MonsterSpawn = CFrame.new(-4881, 22, 4273)
    elseif level >= 150 and level <= 174 then
        QuestData.MonsterName = "Sky Bandit"
        QuestData.QuestName = "SkyQuest"
        QuestData.QuestNum = 1
        QuestData.QuestGiver = CFrame.new(-4839.53027, 716.368591, -2619.44165)
        QuestData.MonsterSpawn = CFrame.new(-4953, 295, -2899)
    else
        -- Default to bandits if level is too high or something goes wrong
        QuestData.MonsterName = "Bandit"
        QuestData.QuestName = "BanditQuest1"
        QuestData.QuestNum = 1
        QuestData.QuestGiver = CFrame.new(1060.93835, 16.4550667, 1547.78418)
        QuestData.MonsterSpawn = CFrame.new(1145, 17, 1634)
    end
end

-- Smooth teleport function
local function teleportTo(targetCF)
    if not char or not rootpart then return end
    
    local distance = (rootpart.Position - targetCF.Position).Magnitude
    local speed = Settings.TweenSpeed
    local time = distance / speed
    
    if time > 0.5 then
        local tween = ts:Create(rootpart, TweenInfo.new(time, Enum.EasingStyle.Linear), {CFrame = targetCF})
        tween:Play()
        tween.Completed:Wait()
    else
        rootpart.CFrame = targetCF
    end
end

-- Get weapon and equip it
local function equipWeapon()
    for _, tool in pairs(player.Backpack:GetChildren()) do
        if tool:IsA("Tool") then
            humanoid:EquipTool(tool)
            return tool
        end
    end
    return nil
end

-- Combat system - multiple methods for reliability
local function attackTarget()
    -- Method 1: Try advanced combat framework
    pcall(function()
        local combatFramework = require(player.PlayerScripts:WaitForChild("CombatFramework"))
        local combatController = combatFramework.activeController
        if combatController then
            combatController.attacking = false
            combatController.timeToNextAttack = 0
            combatController.timeToNextBlock = 0
            combatController.hitboxMagnitude = 55
            combatController.active = false
            combatController.timeToNextAttack = tick() - 2
            combatController.hitboxMagnitude = 55
            combatController.active = false
            combatController.timeToNextBlock = 0
            combatController.blocking = false
            combatController.attacking = false
            combatController.increment = 4
        end
    end)
    
    -- Method 2: Virtual input
    pcall(function()
        vu:CaptureController()
        vu:Button1Down(Vector2.new(851, 158), workspace.CurrentCamera.CFrame)
        wait(0.1)
        vu:Button1Up(Vector2.new(851, 158), workspace.CurrentCamera.CFrame)
    end)
    
    -- Method 3: Tool activation
    pcall(function()
        local tool = char:FindFirstChildOfClass("Tool")
        if tool then
            tool:Activate()
        end
    end)
end

-- Bring mobs function
local function bringMobs()
    if not Settings.BringMobs then return end
    
    for _, mob in pairs(workspace.Enemies:GetChildren()) do
        if mob.Name == QuestData.MonsterName and mob:FindFirstChild("HumanoidRootPart") and mob:FindFirstChild("Humanoid") then
            if mob.Humanoid.Health > 0 then
                local distance = (rootpart.Position - mob.HumanoidRootPart.Position).Magnitude
                if distance <= 350 then
                    -- Make mob easier to hit
                    mob.HumanoidRootPart.Size = Vector3.new(60, 60, 60)
                    mob.HumanoidRootPart.Transparency = 0.8
                    mob.HumanoidRootPart.CanCollide = false
                    mob.Humanoid.WalkSpeed = 0
                    mob.Humanoid.JumpPower = 0
                    
                    -- Teleport mob to player
                    mob.HumanoidRootPart.CFrame = rootpart.CFrame * CFrame.new(0, 0, -5)
                    
                    -- Disable mob's movement
                    if mob.Humanoid then
                        mob.Humanoid.PlatformStand = true
                        mob.Humanoid.Sit = true
                    end
                end
            end
        end
    end
end

-- Take quest function  
local function takeQuest()
    if not Settings.AutoQuest then return end
    
    -- Check if we already have the quest
    local questGui = player.PlayerGui.Main.Quest
    if questGui.Visible then
        local questTitle = questGui.Container.QuestTitle.Title.Text
        if string.find(questTitle, QuestData.MonsterName) then
            return -- Already have correct quest
        end
    end
    
    -- Go to quest giver
    teleportTo(QuestData.QuestGiver)
    wait(0.5)
    
    -- Take the quest
    local args = {
        [1] = "StartQuest",
        [2] = QuestData.QuestName,
        [3] = QuestData.QuestNum
    }
    rep.Remotes.CommF_:InvokeServer(unpack(args))
    wait(0.5)
end

-- Main farming function
local function farmLoop()
    if not Settings.AutoFarm then return end
    
    -- Update quest data based on level
    getQuest()
    
    -- Take quest if needed
    takeQuest()
    
    -- Equip weapon
    equipWeapon()
    
    -- Find target monster
    local targetMob = nil
    for _, mob in pairs(workspace.Enemies:GetChildren()) do
        if mob.Name == QuestData.MonsterName and mob:FindFirstChild("HumanoidRootPart") and mob:FindFirstChild("Humanoid") then
            if mob.Humanoid.Health > 0 then
                targetMob = mob
                break
            end
        end
    end
    
    -- If no mob found, go to spawn area
    if not targetMob then
        teleportTo(QuestData.MonsterSpawn)
        wait(2)
        return
    end
    
    -- Attack the mob
    while targetMob and targetMob.Parent and targetMob.Humanoid.Health > 0 and Settings.AutoFarm do
        -- Position near the mob
        local mobPos = targetMob.HumanoidRootPart.CFrame
        local attackPos = mobPos * CFrame.new(0, 0, Settings.DistanceFromMob)
        
        pcall(function()
            rootpart.CFrame = attackPos
        end)
        
        -- Bring other mobs
        bringMobs()
        
        -- Attack
        attackTarget()
        
        wait(Settings.AttackSpeed)
    end
end

-- Fast attack loop for better DPS
spawn(function()
    while wait() do
        if Settings.AutoFarm then
            pcall(function()
                -- Fast attack method
                local tool = char:FindFirstChildOfClass("Tool")
                if tool then
                    -- Method 1: Combat framework manipulation
                    pcall(function()
                        local cf = require(player.PlayerScripts.CombatFramework)
                        local ac = cf.activeController
                        if ac and ac.blades then
                            if ac.hitboxMagnitude ~= 55 then
                                ac.hitboxMagnitude = 55
                            end
                            ac.active = false
                            ac.timeToNextBlock = 0
                            ac.timeToNextAttack = 0
                            ac.attacking = false
                            ac.blocking = false
                        end
                    end)
                    
                    -- Method 2: Direct tool activation
                    tool:Activate()
                end
            end)
        end
        wait(0.01) -- Very fast loop for maximum attack speed
    end
end)

-- Auto haki activation
spawn(function()
    while wait(1) do
        if Settings.AutoFarm and char then
            if not char:FindFirstChild("HasBuso") then
                rep.Remotes.CommF_:InvokeServer("Buso")
            end
        end
    end
end)

-- Create GUI
local gui = Instance.new("ScreenGui")
gui.Name = "FarmGui"
gui.Parent = player.PlayerGui

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 300, 0, 400)
mainFrame.Position = UDim2.new(0.1, 0, 0.1, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = gui

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 30)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
title.BorderSizePixel = 0
title.Text = "Blox Fruits Farm Hub"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextScaled = true
title.Font = Enum.Font.SourceSansBold
title.Parent = mainFrame

-- Auto Farm Toggle
local autoFarmBtn = Instance.new("TextButton")
autoFarmBtn.Size = UDim2.new(0.9, 0, 0, 40)
autoFarmBtn.Position = UDim2.new(0.05, 0, 0, 50)
autoFarmBtn.BackgroundColor3 = Settings.AutoFarm and Color3.fromRGB(0, 170, 0) or Color3.fromRGB(170, 0, 0)
autoFarmBtn.BorderSizePixel = 0
autoFarmBtn.Text = "Auto Farm: " .. (Settings.AutoFarm and "ON" or "OFF")
autoFarmBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
autoFarmBtn.TextScaled = true
autoFarmBtn.Font = Enum.Font.SourceSans
autoFarmBtn.Parent = mainFrame

autoFarmBtn.MouseButton1Click:Connect(function()
    Settings.AutoFarm = not Settings.AutoFarm
    autoFarmBtn.BackgroundColor3 = Settings.AutoFarm and Color3.fromRGB(0, 170, 0) or Color3.fromRGB(170, 0, 0)
    autoFarmBtn.Text = "Auto Farm: " .. (Settings.AutoFarm and "ON" or "OFF")
end)

-- Auto Quest Toggle  
local autoQuestBtn = Instance.new("TextButton")
autoQuestBtn.Size = UDim2.new(0.9, 0, 0, 40)
autoQuestBtn.Position = UDim2.new(0.05, 0, 0, 100)
autoQuestBtn.BackgroundColor3 = Settings.AutoQuest and Color3.fromRGB(0, 170, 0) or Color3.fromRGB(170, 0, 0)
autoQuestBtn.BorderSizePixel = 0
autoQuestBtn.Text = "Auto Quest: " .. (Settings.AutoQuest and "ON" or "OFF")
autoQuestBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
autoQuestBtn.TextScaled = true
autoQuestBtn.Font = Enum.Font.SourceSans
autoQuestBtn.Parent = mainFrame

autoQuestBtn.MouseButton1Click:Connect(function()
    Settings.AutoQuest = not Settings.AutoQuest
    autoQuestBtn.BackgroundColor3 = Settings.AutoQuest and Color3.fromRGB(0, 170, 0) or Color3.fromRGB(170, 0, 0)
    autoQuestBtn.Text = "Auto Quest: " .. (Settings.AutoQuest and "ON" or "OFF")
end)

-- Bring Mobs Toggle
local bringMobsBtn = Instance.new("TextButton")
bringMobsBtn.Size = UDim2.new(0.9, 0, 0, 40)
bringMobsBtn.Position = UDim2.new(0.05, 0, 0, 150)
bringMobsBtn.BackgroundColor3 = Settings.BringMobs and Color3.fromRGB(0, 170, 0) or Color3.fromRGB(170, 0, 0)
bringMobsBtn.BorderSizePixel = 0
bringMobsBtn.Text = "Bring Mobs: " .. (Settings.BringMobs and "ON" or "OFF")
bringMobsBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
bringMobsBtn.TextScaled = true
bringMobsBtn.Font = Enum.Font.SourceSans
bringMobsBtn.Parent = mainFrame

bringMobsBtn.MouseButton1Click:Connect(function()
    Settings.BringMobs = not Settings.BringMobs
    bringMobsBtn.BackgroundColor3 = Settings.BringMobs and Color3.fromRGB(0, 170, 0) or Color3.fromRGB(170, 0, 0)
    bringMobsBtn.Text = "Bring Mobs: " .. (Settings.BringMobs and "ON" or "OFF")
end)

-- Attack Speed Slider
local speedLabel = Instance.new("TextLabel")
speedLabel.Size = UDim2.new(0.9, 0, 0, 25)
speedLabel.Position = UDim2.new(0.05, 0, 0, 200)
speedLabel.BackgroundTransparency = 1
speedLabel.Text = "Attack Speed: " .. Settings.AttackSpeed
speedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
speedLabel.TextScaled = true
speedLabel.Font = Enum.Font.SourceSans
speedLabel.Parent = mainFrame

local speedSlider = Instance.new("Frame")
speedSlider.Size = UDim2.new(0.9, 0, 0, 20)
speedSlider.Position = UDim2.new(0.05, 0, 0, 230)
speedSlider.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
speedSlider.BorderSizePixel = 0
speedSlider.Parent = mainFrame

local speedHandle = Instance.new("TextButton")
speedHandle.Size = UDim2.new(0, 20, 1, 0)
speedHandle.Position = UDim2.new((1 - Settings.AttackSpeed) * 0.9, 0, 0, 0)
speedHandle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
speedHandle.BorderSizePixel = 0
speedHandle.Text = ""
speedHandle.Parent = speedSlider

-- Info display
local infoLabel = Instance.new("TextLabel")
infoLabel.Size = UDim2.new(0.9, 0, 0, 80)
infoLabel.Position = UDim2.new(0.05, 0, 0, 270)
infoLabel.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
infoLabel.BorderSizePixel = 0
infoLabel.Text = "Level: " .. player.Data.Level.Value .. "\nTarget: " .. QuestData.MonsterName
infoLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
infoLabel.TextScaled = true
infoLabel.Font = Enum.Font.SourceSans
infoLabel.Parent = mainFrame

-- Update info periodically
spawn(function()
    while gui.Parent do
        wait(1)
        if player.Data and player.Data.Level then
            getQuest() -- Update quest data
            infoLabel.Text = "Level: " .. player.Data.Level.Value .. "\nTarget: " .. QuestData.MonsterName .. "\nQuest: " .. QuestData.QuestName
        end
    end
end)

-- Main farming loop
spawn(function()
    while gui.Parent do
        if Settings.AutoFarm then
            pcall(farmLoop)
        end
        wait(0.1)
    end
end)

-- Auto-equip best weapon
spawn(function()
    while gui.Parent do
        if Settings.AutoFarm then
            pcall(function()
                local bestTool = nil
                local highestDamage = 0
                
                for _, tool in pairs(player.Backpack:GetChildren()) do
                    if tool:IsA("Tool") and tool:FindFirstChild("Level") then
                        local damage = tool.Level.Value or 1
                        if damage > highestDamage then
                            highestDamage = damage
                            bestTool = tool
                        end
                    end
                end
                
                -- If no tool with level found, just get first tool
                if not bestTool then
                    for _, tool in pairs(player.Backpack:GetChildren()) do
                        if tool:IsA("Tool") then
                            bestTool = tool
                            break
                        end
                    end
                end
                
                if bestTool and not char:FindFirstChildOfClass("Tool") then
                    humanoid:EquipTool(bestTool)
                end
            end)
        end
        wait(5)
    end
end)

print("Blox Fruits Farm Script Loaded Successfully!")
print("Made by xX_ProGamer_Xx")
print("Current Level:", player.Data.Level.Value)
print("Target Monster:", QuestData.MonsterName)
