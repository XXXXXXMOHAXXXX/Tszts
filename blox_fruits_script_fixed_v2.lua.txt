-- ENCHANTED HUB | BLOX FRUITS SEA 1
-- Created by AABIS & moha
-- PATCHED: Stable float + guaranteed damage from above by Copilot

if not game:IsLoaded() then 
    repeat game.Loaded:Wait() until game:IsLoaded() 
end

-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local TweenService = game:GetService("TweenService")
local VirtualUser = game:GetService("VirtualUser")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer
local Character, HumanoidRootPart

local function UpdateCharacter()
    Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    if Character then
        HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")
    end
end

UpdateCharacter()
LocalPlayer.CharacterAdded:Connect(UpdateCharacter)

-- Anti-AFK
spawn(function()
    while wait(60) do
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
    end
end)

-- Sea 1 check
if game.PlaceId ~= 2753915549 then
    LocalPlayer:Kick("This script only works in Blox Fruits Sea 1!")
    return
end

getgenv().Settings = {
    SelectedWeapon = "",
    FastAttack = false,
    AutoHaki = false,
    BringMob = false,
    ESPFruit = false,
    BringFruit = false,
    StoreFruit = false,
    AutoFarmLevel = false,
    SelectedBoss = "",
    AutoKillBoss = false,
    AutoSaber = false,
    AutoSecondSea = false,
    MagnetRange = 25,
    AttackDelay = 0.1
}

local function Notification(title, text, duration)
    pcall(function()
        game.StarterGui:SetCore("SendNotification", {
            Title = title,
            Text = text,
            Duration = duration or 5
        })
    end)
end

local function GetPlayerStats()
    local stats = {}
    stats.Level = LocalPlayer.Data.Level.Value
    stats.Money = LocalPlayer.Data.Beli.Value
    stats.Race = LocalPlayer.Data.Race.Value
    stats.Bounty = LocalPlayer.leaderstats["Bounty/Honor"].Value
    stats.Sea = "First Sea"
    return stats
end

local function GetDistance(pos1, pos2)
    return (pos1 - pos2).Magnitude
end

-- PATCH: Stable floating above mob
local function StableFloatAbove(targetCFrame, yOffset, floatTime)
    if not HumanoidRootPart then UpdateCharacter() end
    yOffset = yOffset or 28
    floatTime = floatTime or 0.25
    local start = tick()
    local desired = CFrame.new(targetCFrame.Position.X, targetCFrame.Position.Y + yOffset, targetCFrame.Position.Z)
    local bp = Instance.new("BodyPosition")
    bp.MaxForce = Vector3.new(1e5, 1e5, 1e5)
    bp.P = 2e4
    bp.D = 1e3
    bp.Position = desired.Position
    bp.Parent = HumanoidRootPart
    local bg = Instance.new("BodyGyro")
    bg.MaxTorque = Vector3.new(1e5, 1e5, 1e5)
    bg.CFrame = CFrame.new(bp.Position, targetCFrame.Position)
    bg.P = 1e5
    bg.Parent = HumanoidRootPart
    while tick() - start < floatTime and HumanoidRootPart and Character and Character:FindFirstChild("Humanoid") and Character.Humanoid.Health > 0 do
        bp.Position = Vector3.new(targetCFrame.Position.X, targetCFrame.Position.Y + yOffset, targetCFrame.Position.Z)
        bg.CFrame = CFrame.new(HumanoidRootPart.Position, targetCFrame.Position)
        RunService.RenderStepped:Wait()
    end
    pcall(function() bp:Destroy() end)
    pcall(function() bg:Destroy() end)
end

-- PATCH: Large hitbox attack from above, guaranteed damage if within 30 studs
local function AttackFromAbove(monster)
    if not monster or not monster:FindFirstChild("HumanoidRootPart") or not monster:FindFirstChild("Humanoid") then return end
    local hrp = monster.HumanoidRootPart
    hrp.Size = Vector3.new(80, 80, 80)
    hrp.CanCollide = false
    if GetDistance(HumanoidRootPart.Position, hrp.Position) <= 30 then
        local above = HumanoidRootPart.Position.Y > hrp.Position.Y + 7
        if above then
            HumanoidRootPart.CFrame = CFrame.new(hrp.Position.X, hrp.Position.Y + 9, hrp.Position.Z)
            wait(0.03)
        end
        local tool = LocalPlayer.Character:FindFirstChildOfClass("Tool")
        if tool and tool:FindFirstChild("Handle") then
            tool:Activate()
        end
        VirtualUser:CaptureController()
        VirtualUser:Button1Down(Vector2.new(851, 158))
        VirtualUser:Button1Up(Vector2.new(851, 158))
        if above then
            HumanoidRootPart.CFrame = CFrame.new(hrp.Position.X, hrp.Position.Y + 27, hrp.Position.Z)
        end
    end
end

local function TweenTo(targetCFrame, speed)
    if not HumanoidRootPart then UpdateCharacter() end
    speed = speed or 350
    local safeY = math.max(targetCFrame.Position.Y, 50)
    local safeCFrame = CFrame.new(targetCFrame.Position.X, safeY, targetCFrame.Position.Z)
    local distance = GetDistance(HumanoidRootPart.Position, safeCFrame.Position)
    local time = distance / speed
    if getgenv().currentTween then
        getgenv().currentTween:Cancel()
    end
    local tween = TweenService:Create(
        HumanoidRootPart,
        TweenInfo.new(time, Enum.EasingStyle.Linear),
        {CFrame = safeCFrame}
    )
    getgenv().currentTween = tween
    tween:Play()
    return tween
end

local function EquipWeapon(weaponName)
    if LocalPlayer.Backpack:FindFirstChild(weaponName) then
        LocalPlayer.Character.Humanoid:EquipTool(LocalPlayer.Backpack[weaponName])
        return true
    end
    return false
end

local function GetAllWeapons()
    local weapons = {}
    for _, tool in pairs(LocalPlayer.Backpack:GetChildren()) do
        if tool:IsA("Tool") then
            table.insert(weapons, tool.Name)
        end
    end
    for _, tool in pairs(LocalPlayer.Character:GetChildren()) do
        if tool:IsA("Tool") then
            table.insert(weapons, tool.Name)
        end
    end
    return weapons
end

-- Quest Data (unchanged)
local QuestData = {
    [1] = {Name = "BanditQuest1", Number = 1, Monster = "Bandit", Level = 5, QuestPos = CFrame.new(1059.37195, 15.4495068, 1550.4231)},
    [10] = {Name = "JungleQuest", Number = 1, Monster = "Monkey", Level = 14, QuestPos = CFrame.new(-1598.08911, 35.5501175, 153.377838)},
    [15] = {Name = "JungleQuest", Number = 2, Monster = "Gorilla", Level = 20, QuestPos = CFrame.new(-1598.08911, 35.5501175, 153.377838)},
    [30] = {Name = "BuggyQuest1", Number = 1, Monster = "Pirate", Level = 35, QuestPos = CFrame.new(-1141.07483, 4.10001802, 3831.5498)},
    [60] = {Name = "DesertQuest", Number = 1, Monster = "Desert Bandit", Level = 60, QuestPos = CFrame.new(894.488647, 5.14000702, 4392.43359)},
    [75] = {Name = "DesertQuest", Number = 2, Monster = "Desert Officer", Level = 70, QuestPos = CFrame.new(894.488647, 5.14000702, 4392.43359)},
    [90] = {Name = "SnowQuest", Number = 1, Monster = "Snow Bandit", Level = 90, QuestPos = CFrame.new(1389.74451, 88.1519318, -1298.90796)},
    [100] = {Name = "SnowQuest", Number = 2, Monster = "Snowman", Level = 100, QuestPos = CFrame.new(1389.74451, 88.1519318, -1298.90796)},
    [120] = {Name = "MarineQuest2", Number = 1, Monster = "Chief Petty Officer", Level = 120, QuestPos = CFrame.new(-5039.58643, 27.3500385, 4324.68018)},
    [150] = {Name = "SkyQuest", Number = 1, Monster = "Sky Bandit", Level = 150, QuestPos = CFrame.new(-4839.53027, 716.368591, -2619.44165)},
    [175] = {Name = "SkyQuest", Number = 2, Monster = "Dark Master", Level = 175, QuestPos = CFrame.new(-4839.53027, 716.368591, -2619.44165)},
    [190] = {Name = "PrisonerQuest", Number = 1, Monster = "Prisoner", Level = 190, QuestPos = CFrame.new(5308.93115, 1.65517521, 475.120514)},
    [210] = {Name = "PrisonerQuest", Number = 2, Monster = "Dangerous Prisoner", Level = 210, QuestPos = CFrame.new(5308.93115, 1.65517521, 475.120514)},
    [250] = {Name = "ColosseumQuest", Number = 1, Monster = "Toga Warrior", Level = 250, QuestPos = CFrame.new(-1580.04663, 6.35000277, -2986.47534)},
    [300] = {Name = "MagmaQuest", Number = 1, Monster = "Military Soldier", Level = 300, QuestPos = CFrame.new(-5313.37012, 10.9500084, 8515.29395)},
    [325] = {Name = "MagmaQuest", Number = 2, Monster = "Military Spy", Level = 325, QuestPos = CFrame.new(-5313.37012, 10.9500084, 8515.29395)},
    [375] = {Name = "FishmanQuest", Number = 1, Monster = "Fishman Warrior", Level = 375, QuestPos = CFrame.new(61122.65234375, 18.497442245483, 1569.3997802734)},
    [400] = {Name = "FishmanQuest", Number = 2, Monster = "Fishman Commando", Level = 400, QuestPos = CFrame.new(61122.65234375, 18.497442245483, 1569.3997802734)},
    [450] = {Name = "SkyExp1Quest", Number = 1, Monster = "God's Guard", Level = 450, QuestPos = CFrame.new(-4721.88867, 843.874695, -1949.96643)},
    [475] = {Name = "SkyExp1Quest", Number = 2, Monster = "Shanda", Level = 475, QuestPos = CFrame.new(-7859.09814, 5544.19043, -381.476196)},
    [525] = {Name = "SkyExp2Quest", Number = 1, Monster = "Royal Squad", Level = 525, QuestPos = CFrame.new(-7906.81592, 5634.6626, -1411.99194)},
    [550] = {Name = "SkyExp2Quest", Number = 2, Monster = "Royal Soldier", Level = 550, QuestPos = CFrame.new(-7906.81592, 5634.6626, -1411.99194)},
    [625] = {Name = "FountainQuest", Number = 1, Monster = "Galley Pirate", Level = 625, QuestPos = CFrame.new(5253.54834, 38.5361786, 4050.45166)},
    [700] = {Name = "FountainQuest", Number = 2, Monster = "Galley Captain", Level = 650, QuestPos = CFrame.new(5253.54834, 38.5361786, 4050.45166)}
}

local function GetCurrentQuest()
    local level = LocalPlayer.Data.Level.Value
    local bestQuest = nil
    for levelReq, questInfo in pairs(QuestData) do
        if level >= levelReq then
            bestQuest = questInfo
        end
    end
    return bestQuest
end

-- Monster Positions (unchanged)
local MonsterSpawns = {
    ["Bandit"] = CFrame.new(1045.962646484375, 27.00250244140625, 1560.8203125),
    ["Monkey"] = CFrame.new(-1448.51806640625, 67.85301208496094, 11.46579647064209),
    ["Gorilla"] = CFrame.new(-1129.8836669921875, 40.46354675292969, -525.4237060546875),
    ["Pirate"] = CFrame.new(-1103.513427734375, 13.752052307128906, 3896.091064453125),
    ["Desert Bandit"] = CFrame.new(924.7684326171875, 6.906005859375, 4481.5859375),
    ["Desert Officer"] = CFrame.new(1608.2822265625, 14.452187538146973, 4371.00732421875),
    ["Snow Bandit"] = CFrame.new(1354.347900390625, 87.27835845947266, -1393.946044921875),
    ["Snowman"] = CFrame.new(1197.33154296875, 144.83154296875, -1550.0670166015625),
    ["Chief Petty Officer"] = CFrame.new(-4881.23095703125, 22.65204429626465, 4273.75244140625),
    ["Sky Bandit"] = CFrame.new(-4953.20703125, 295.74420166015625, -2899.22998046875),
    ["Dark Master"] = CFrame.new(-5259.8447265625, 391.3976745605469, -2229.035400390625),
    ["Prisoner"] = CFrame.new(5098.9384765625, 13.827401161193848, 426.2115173339844),
    ["Dangerous Prisoner"] = CFrame.new(5654.5634765625, 15.633401870727539, 747.2021484375),
    ["Toga Warrior"] = CFrame.new(-1820.21728515625, 51.68385696411133, -2740.6650390625),
    ["Military Soldier"] = CFrame.new(-5408.267578125, 11.081554412841797, 8490.7578125),
    ["Military Spy"] = CFrame.new(-5802.8681640625, 86.26271057128906, 8828.859375),
    ["Fishman Warrior"] = CFrame.new(60906.81640625, 81.25484466552734, 1553.984375),
    ["Fishman Commando"] = CFrame.new(61922.6328125, 26.50629425048828, 1493.2120361328125),
    ["God's Guard"] = CFrame.new(-4710.04443359375, 845.2769775390625, -1927.3079833984375),
    ["Shanda"] = CFrame.new(-7678.48974609375, 5566.40380859375, -497.2156677246094),
    ["Royal Squad"] = CFrame.new(-7624.25927734375, 5658.13330078125, -1467.354736328125),
    ["Royal Soldier"] = CFrame.new(-7836.75341796875, 5645.6572265625, -1790.6236572265625),
    ["Galley Pirate"] = CFrame.new(5551.02197265625, 78.90135192871094, 3930.412841796875),
    ["Galley Captain"] = CFrame.new(5441.95654296875, 42.50205993652344, 4861.0224609375)
}

-- Boss Data (unchanged)
local BossData = {
    ["The Gorilla King"] = {Level = 25, Position = CFrame.new(-1223.52808, 6.27936459, -502.292664)},
    ["Bobby"] = {Level = 55, Position = CFrame.new(-1147.65173, 32.5966301, 4156.02588)},
    ["Yeti"] = {Level = 110, Position = CFrame.new(1221.7356, 138.046906, -1488.84082)},
    ["Mob Leader"] = {Level = 120, Position = CFrame.new(-2848.59399, 7.4272871, 5342.44043)},
    ["Vice Admiral"] = {Level = 130, Position = CFrame.new(-5078.45898, 99.6520691, 4402.1665)},
    ["Warden"] = {Level = 220, Position = CFrame.new(5232.5625, 5.26856995, 747.506897)},
    ["Chief Warden"] = {Level = 230, Position = CFrame.new(5232.5625, 5.26856995, 747.506897)},
    ["Swan"] = {Level = 240, Position = CFrame.new(5232.5625, 5.26856995, 747.506897)},
    ["Magma Admiral"] = {Level = 350, Position = CFrame.new(-5530.12646, 22.8769703, 8859.91309)},
    ["Fishman Lord"] = {Level = 425, Position = CFrame.new(61351.7109375, 31.0129776000977, 1113.31689453125)},
    ["Wysper"] = {Level = 500, Position = CFrame.new(-7925.48389, 5550.76074, -636.178345)},
    ["Thunder God"] = {Level = 575, Position = CFrame.new(-7748.0185546875, 5606.80615234375, -2305.898681640625)},
    ["Cyborg"] = {Level = 675, Position = CFrame.new(6041.82373046875, 52.7312507629395, 3907.5)}
}

-- Combat System
getgenv().AttackEnabled = false

local function AttackFunction()
    if not getgenv().AttackEnabled then return end
    spawn(function()
        local tool = LocalPlayer.Character:FindFirstChildOfClass("Tool")
        if tool and tool:FindFirstChild("Handle") then
            tool:Activate()
        end
        VirtualUser:CaptureController()
        VirtualUser:Button1Down(Vector2.new(851, 158))
        VirtualUser:Button1Up(Vector2.new(851, 158))
        local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid:ChangeState(Enum.HumanoidStateType.Attacking)
        end
    end)
end

local function FastAttack()
    spawn(function()
        while Settings.FastAttack do
            getgenv().AttackEnabled = true
            wait(Settings.AttackDelay)
            if Settings.FastAttack then
                AttackFunction()
            end
        end
        getgenv().AttackEnabled = false
    end)
end

local function AutoHaki()
    spawn(function()
        while Settings.AutoHaki do
            wait(0.1)
            pcall(function()
                if not LocalPlayer.Character:FindFirstChild("HasBuso") then
                    ReplicatedStorage.Remotes.CommF_:InvokeServer("Buso")
                end
            end)
        end
    end)
end

local function BringMobs()
    spawn(function()
        while Settings.BringMob do
            wait()
            pcall(function()
                if not HumanoidRootPart then UpdateCharacter() end
                for _, mob in pairs(Workspace.Enemies:GetChildren()) do
                    if mob:FindFirstChild("HumanoidRootPart") and mob:FindFirstChild("Humanoid") then
                        if mob.Humanoid.Health > 0 and GetDistance(mob.HumanoidRootPart.Position, HumanoidRootPart.Position) <= Settings.MagnetRange then
                            mob.HumanoidRootPart.CFrame = HumanoidRootPart.CFrame * CFrame.new(0, 0, -5)
                            mob.HumanoidRootPart.CanCollide = false
                            mob.Humanoid.WalkSpeed = 0
                            mob.Humanoid.JumpPower = 0
                            mob.HumanoidRootPart.Size = Vector3.new(50, 50, 50)
                            if mob:FindFirstChildOfClass("BodyVelocity") then
                                mob:FindFirstChildOfClass("BodyVelocity"):Destroy()
                            end
                            if mob:FindFirstChildOfClass("BodyPosition") then  
                                mob:FindFirstChildOfClass("BodyPosition"):Destroy()
                            end
                            if mob:FindFirstChildOfClass("BodyAngularVelocity") then
                                mob:FindFirstChildOfClass("BodyAngularVelocity"):Destroy()
                            end
                        end
                    end
                end
            end)
        end
    end)
end

local function CreateESPFruit()
    spawn(function()
        while Settings.ESPFruit do
            wait(1)
            pcall(function()
                for _, obj in pairs(Workspace:GetChildren()) do
                    if string.find(obj.Name, "Fruit") and not obj:FindFirstChild("ESP") then
                        local esp = Instance.new("BillboardGui")
                        esp.Name = "ESP"
                        esp.Parent = obj
                        esp.AlwaysOnTop = true
                        esp.LightInfluence = 0
                        esp.Size = UDim2.new(0, 50, 0, 50)
                        local frame = Instance.new("Frame")
                        frame.Parent = esp
                        frame.Size = UDim2.new(1, 0, 1, 0)
                        frame.BackgroundTransparency = 0.5
                        frame.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
                        local text = Instance.new("TextLabel")
                        text.Parent = frame
                        text.Size = UDim2.new(1, 0, 1, 0)
                        text.Text = obj.Name
                        text.TextColor3 = Color3.fromRGB(255, 255, 255)
                        text.TextScaled = true
                        text.BackgroundTransparency = 1
                    elseif not Settings.ESPFruit and obj:FindFirstChild("ESP") then
                        obj.ESP:Destroy()
                    end
                end
            end)
        end
    end)
end

local function BringFruits()
    spawn(function()
        while Settings.BringFruit do
            wait(0.5)
            pcall(function()
                if not HumanoidRootPart then UpdateCharacter() end
                for _, obj in pairs(Workspace:GetChildren()) do
                    if string.find(obj.Name, "Fruit") and obj:FindFirstChild("Handle") then
                        obj.Handle.CFrame = HumanoidRootPart.CFrame * CFrame.new(0, 0, -3)
                    end
                end
            end)
        end
    end)
end

local function StoreFruit()
    spawn(function()
        while Settings.StoreFruit do
            wait(1)
            pcall(function()
                ReplicatedStorage.Remotes.CommF_:InvokeServer("StoreFruit", "Fruit-Fruit", LocalPlayer.Backpack:FindFirstChild("Fruit"))
            end)
        end
    end)
end

local function AutoFarmLevel()
    spawn(function()
        while Settings.AutoFarmLevel do
            wait()
            pcall(function()
                local quest = GetCurrentQuest()
                if quest then
                    if not LocalPlayer.PlayerGui.Main.Quest.Visible then
                        TweenTo(quest.QuestPos)
                        wait(2)
                        ReplicatedStorage.Remotes.CommF_:InvokeServer("StartQuest", quest.Name, quest.Number)
                        wait(1)
                    else
                        local monsters = {}
                        for _, mob in pairs(Workspace.Enemies:GetChildren()) do
                            if string.find(mob.Name, quest.Monster) and mob:FindFirstChild("HumanoidRootPart") and mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 then
                                table.insert(monsters, mob)
                            end
                        end
                        if #monsters > 0 then
                            local target = monsters[1]
                            if Settings.SelectedWeapon ~= "" then
                                EquipWeapon(Settings.SelectedWeapon)
                            end
                            repeat
                                wait()
                                if target and target.Parent and target:FindFirstChild("HumanoidRootPart") and target.Humanoid.Health > 0 then
                                    StableFloatAbove(target.HumanoidRootPart.CFrame, 27, 0.25)
                                    AttackFromAbove(target)
                                else
                                    break
                                end
                            until not target.Parent or target.Humanoid.Health <= 0 or not Settings.AutoFarmLevel
                        else
                            if MonsterSpawns[quest.Monster] then
                                TweenTo(MonsterSpawns[quest.Monster])
                            end
                        end
                    end
                end
            end)
        end
    end)
end

local function AutoKillBoss()
    spawn(function()
        while Settings.AutoKillBoss do
            wait()
            pcall(function()
                if Settings.SelectedBoss ~= "" then
                    local boss = Workspace.Enemies:FindFirstChild(Settings.SelectedBoss)
                    if boss and boss:FindFirstChild("HumanoidRootPart") and boss:FindFirstChild("Humanoid") then
                        if boss.Humanoid.Health > 0 then
                            if Settings.SelectedWeapon ~= "" then
                                EquipWeapon(Settings.SelectedWeapon)
                            end
                            repeat
                                wait()
                                if boss and boss.Parent and boss:FindFirstChild("HumanoidRootPart") and boss.Humanoid.Health > 0 then
                                    StableFloatAbove(boss.HumanoidRootPart.CFrame, 35, 0.25)
                                    AttackFromAbove(boss)
                                else
                                    break
                                end
                            until not boss.Parent or boss.Humanoid.Health <= 0 or not Settings.AutoKillBoss
                        end
                    else
                        if BossData[Settings.SelectedBoss] then
                            TweenTo(BossData[Settings.SelectedBoss].Position)
                        end
                    end
                end
            end)
        end
    end)
end

local function AutoSaber()
    spawn(function()
        while Settings.AutoSaber do
            wait()
            pcall(function()
                if LocalPlayer.Data.Level.Value >= 200 then
                    if not LocalPlayer.Backpack:FindFirstChild("Saber") and not LocalPlayer.Character:FindFirstChild("Saber") then
                        local saberExpert = Workspace.Enemies:FindFirstChild("Saber Expert")
                        if saberExpert and saberExpert:FindFirstChild("HumanoidRootPart") and saberExpert:FindFirstChild("Humanoid") then
                            if saberExpert.Humanoid.Health > 0 then
                                if Settings.SelectedWeapon ~= "" then
                                    EquipWeapon(Settings.SelectedWeapon)
                                end
                                repeat
                                    wait()
                                    if saberExpert and saberExpert.Parent and saberExpert:FindFirstChild("HumanoidRootPart") and saberExpert.Humanoid.Health > 0 then
                                        StableFloatAbove(saberExpert.HumanoidRootPart.CFrame, 35, 0.25)
                                        AttackFromAbove(saberExpert)
                                    else
                                        break
                                    end
                                until not saberExpert.Parent or saberExpert.Humanoid.Health <= 0 or not Settings.AutoSaber
                            end
                        else
                            TweenTo(CFrame.new(-1405.41956, 29.8519993, -50.0738258))
                        end
                    else
                        Settings.AutoSaber = false
                        Notification("Auto Saber", "Saber obtained!", 5)
                    end
                else
                    Notification("Auto Saber", "Need level 200+", 3)
                    Settings.AutoSaber = false
                end
            end)
        end
    end)
end

local function AutoSecondSea()
    spawn(function()
        while Settings.AutoSecondSea do
            wait()
            pcall(function()
                if LocalPlayer.Data.Level.Value >= 700 then
                    local questProgress = game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("DressrosaQuestProgress","Detective")
                    if questProgress == 0 then
                        TweenTo(CFrame.new(-5496.17432, 313.768921, -2841.53027))
                        wait(3)
                        ReplicatedStorage.Remotes.CommF_:InvokeServer("DressrosaQuestProgress","Detective")
                        wait(1)
                    elseif questProgress == 1 then
                        TweenTo(CFrame.new(-5533.86426, 313.800995, -2766.69678))
                        wait(3)
                        ReplicatedStorage.Remotes.CommF_:InvokeServer("DressrosaQuestProgress","Detective")
                        wait(1)
                    elseif questProgress == 2 then
                        TweenTo(CFrame.new(-5607.5, 313.800995, -2851.5))
                        wait(3)
                        ReplicatedStorage.Remotes.CommF_:InvokeServer("DressrosaQuestProgress","Detective")
                        wait(1)
                    elseif questProgress == 3 then
                        TweenTo(CFrame.new(-5565.86816, 313.800995, -2913.43311))
                        wait(3)
                        ReplicatedStorage.Remotes.CommF_:InvokeServer("DressrosaQuestProgress","Detective")
                        wait(1)
                    elseif questProgress == 4 then
                        TweenTo(CFrame.new(-5444.6001, 313.768921, -2925.11816))
                        wait(3)
                        ReplicatedStorage.Remotes.CommF_:InvokeServer("DressrosaQuestProgress","Detective")
                        wait(1)
                    elseif questProgress == 5 then
                        TweenTo(CFrame.new(-5763.48438, 298.665588, -2457.56885))
                        wait(3)
                        game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("TravelDressrosa") 
                        Settings.AutoSecondSea = false
                        Notification("Second Sea", "Traveling to Second Sea!", 5)
                    end
                else
                    Notification("Second Sea", "Need level 700+", 3)
                    Settings.AutoSecondSea = false
                end
            end)
        end
    end)
end

-- UI Creation
local Show_Button = true
local Button_Icon = "rbxassetid://135671141026630"
local Button_Transparency = 0.1

local ScreenGui = Instance.new("ScreenGui")
local ImageButton = Instance.new("ImageButton")
local UICorner = Instance.new("UICorner")
local UIStroke = Instance.new("UIStroke")
local UIGradient = Instance.new("UIGradient")
local UIScale = Instance.new("UIScale")

ScreenGui.Name = "EnchantedHubButton"
ScreenGui.Parent = game.CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

ImageButton.Parent = ScreenGui
ImageButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
ImageButton.BackgroundTransparency = Button_Transparency
ImageButton.BorderSizePixel = 0
ImageButton.Position = UDim2.new(0.05, 0, 0.1, 0)
ImageButton.Size = UDim2.new(0, 70, 0, 70)
ImageButton.Image = Button_Icon
ImageButton.Draggable = true
ImageButton.ImageTransparency = 0

UICorner.CornerRadius = UDim.new(0, 20)
UICorner.Parent = ImageButton

UIStroke.Parent = ImageButton
UIStroke.Color = Color3.fromRGB(0, 150, 255)
UIStroke.Thickness = 4
UIStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

UIGradient.Parent = ImageButton
UIGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(135, 206, 250)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(70, 130, 180))
}
UIGradient.Rotation = 45

UIScale.Parent = ImageButton
UIScale.Scale = 1

local function animateButton()
    local tween1 = TweenService:Create(
        UIScale,
        TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut),
        {Scale = 0.8}
    )
    tween1:Play()
    tween1.Completed:Connect(function()
        local tween2 = TweenService:Create(
            UIScale,
            TweenInfo.new(0.1, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
            {Scale = 1.1}
        )
        tween2:Play()
        tween2.Completed:Connect(function()
            local tween3 = TweenService:Create(
                UIScale,
                TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
                {Scale = 1}
            )
            tween3:Play()
        end)
    end)
end

-- Load UI Library
wait(3)

local success, Fluent = pcall(function()
    return loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
end)

if not success then
    Notification("Error", "Failed to load UI library", 5)
    return
end

local Window = Fluent:CreateWindow({
    Title = "ENCHANTED HUB | BLOX FRUIT SEA 1",
    SubTitle = "Created by AABIS & moha",
    TabWidth = 125,
    Size = UDim2.fromOffset(650, 520),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.LeftControl
})

-- Create Tabs
local Tabs = {
    Main = Window:AddTab({ Title = "Main", Icon = "home" }),
    AutoFarm = Window:AddTab({ Title = "Auto Farm", Icon = "zap" }),
    Settings = Window:AddTab({ Title = "Settings", Icon = "settings" })
}

-- Main Tab
local CombatSection = Tabs.Main:AddSection("Combat")

local WeaponDropdown = Tabs.Main:AddDropdown("WeaponSelect", {
    Title = "Choose Weapon",
    Values = {},
    Multi = false,
    Default = "",
})

WeaponDropdown:OnChanged(function(Value)
    Settings.SelectedWeapon = Value
end)

spawn(function()
    while wait(2) do
        local weapons = GetAllWeapons()
        WeaponDropdown:SetValues(weapons)
    end
end)

local FastAttackToggle = Tabs.Main:AddToggle("FastAttack", {
    Title = "Fast Attack",
    Default = false
})

FastAttackToggle:OnChanged(function(Value)
    Settings.FastAttack = Value
    if Value then
        FastAttack()
    end
end)

local AutoHakiToggle = Tabs.Main:AddToggle("AutoHaki", {
    Title = "Auto Armament Haki",
    Default = false
})

AutoHakiToggle:OnChanged(function(Value)
    Settings.AutoHaki = Value
    if Value then
        AutoHaki()
    end
end)

local BringMobToggle = Tabs.Main:AddToggle("BringMob", {
    Title = "Bring Mob",
    Default = false
})

BringMobToggle:OnChanged(function(Value)
    Settings.BringMob = Value
    if Value then
        BringMobs()
    end
end)

-- Fruits Section
local FruitsSection = Tabs.Main:AddSection("Fruits")

local ESPFruitToggle = Tabs.Main:AddToggle("ESPFruit", {
    Title = "ESP Fruit",
    Default = false
})

ESPFruitToggle:OnChanged(function(Value)
    Settings.ESPFruit = Value
    if Value then
        CreateESPFruit()
    end
end)

local BringFruitToggle = Tabs.Main:AddToggle("BringFruit", {
    Title = "Bring Fruit",
    Default = false
})

BringFruitToggle:OnChanged(function(Value)
    Settings.BringFruit = Value
    if Value then
        BringFruits()
    end
end)

local StoreFruitToggle = Tabs.Main:AddToggle("StoreFruit", {
    Title = "Store Fruit",
    Default = false
})

StoreFruitToggle:OnChanged(function(Value)
    Settings.StoreFruit = Value
    if Value then
        StoreFruit()
    end
end)

-- Player Stats Section
local StatsSection = Tabs.Main:AddSection("Player Stats")

local StatsLabel = Tabs.Main:AddParagraph({
    Title = "Current Stats",
    Content = "Loading..."
})

spawn(function()
    while wait(5) do
        pcall(function()
            local stats = GetPlayerStats()
            local content = string.format(
                "Level: %d\nMoney: %s\nRace: %s\nBounty: %s\nSea: %s",
                stats.Level,
                tostring(stats.Money),
                stats.Race,
                tostring(stats.Bounty),
                stats.Sea
            )
            StatsLabel:SetContent(content)
        end)
    end
end)

-- Auto Farm Tab
local FarmSection = Tabs.AutoFarm:AddSection("Auto Farm Level")

local AutoFarmToggle = Tabs.AutoFarm:AddToggle("AutoFarmLevel", {
    Title = "Auto Farm Level",
    Default = false
})

AutoFarmToggle:OnChanged(function(Value)
    Settings.AutoFarmLevel = Value
    if Value then
        AutoFarmLevel()
        if Settings.AutoHaki then AutoHaki() end
        if Settings.BringMob then BringMobs() end
    end
end)

-- Boss Section
local BossSection = Tabs.AutoFarm:AddSection("Boss")

local BossDropdown = Tabs.AutoFarm:AddDropdown("BossSelect", {
    Title = "Select Boss",
    Values = {},
    Multi = false,
    Default = "",
})

local bossList = {}
for bossName, _ in pairs(BossData) do
    table.insert(bossList, bossName)
end
BossDropdown:SetValues(bossList)

BossDropdown:OnChanged(function(Value)
    Settings.SelectedBoss = Value
end)

local AutoKillBossToggle = Tabs.AutoFarm:AddToggle("AutoKillBoss", {
    Title = "Auto Kill Boss",
    Default = false
})

AutoKillBossToggle:OnChanged(function(Value)
    Settings.AutoKillBoss = Value
    if Value then
        AutoKillBoss()
    end
end)

-- Special Quests Section
local QuestSection = Tabs.AutoFarm:AddSection("Special Quests")

local AutoSaberToggle = Tabs.AutoFarm:AddToggle("AutoSaber", {
    Title = "Auto Saber Sword",
    Default = false
})

AutoSaberToggle:OnChanged(function(Value)
    Settings.AutoSaber = Value
    if Value then
        AutoSaber()
    end
end)

local AutoSecondSeaToggle = Tabs.AutoFarm:AddToggle("AutoSecondSea", {
    Title = "Auto Second Sea (Lv.700)",
    Default = false
})

AutoSecondSeaToggle:OnChanged(function(Value)
    Settings.AutoSecondSea = Value
    if Value then
        AutoSecondSea()
    end
end)

-- Settings Tab
local GeneralSection = Tabs.Settings:AddSection("General")

local MagnetSlider = Tabs.Settings:AddSlider("MagnetRange", {
    Title = "Magnet Range",
    Description = "Range for bringing mobs",
    Default = 25,
    Min = 10,
    Max = 50,
    Rounding = 1,
    Callback = function(Value)
        Settings.MagnetRange = Value
    end
})

local AttackDelaySlider = Tabs.Settings:AddSlider("AttackDelay", {
    Title = "Attack Delay",
    Description = "Delay between attacks (seconds)",
    Default = 0.1,
    Min = 0.05,
    Max = 1,
    Rounding = 2,
    Callback = function(Value)
        Settings.AttackDelay = Value
    end
})

-- Performance Section
local PerformanceSection = Tabs.Settings:AddSection("Performance")

local FPSBoostToggle = Tabs.Settings:AddToggle("FPSBoost", {
    Title = "FPS Boost",
    Default = false
})

FPSBoostToggle:OnChanged(function(Value)
    if Value then
        local lighting = game:GetService("Lighting")
        lighting.GlobalShadows = false
        lighting.FogEnd = 9e9
        lighting.Brightness = 0
        settings().Rendering.QualityLevel = "Level01"
        for _, v in pairs(game:GetDescendants()) do
            if v:IsA("Part") or v:IsA("Union") or v:IsA("CornerWedgePart") or v:IsA("TrussPart") then
                v.Material = "Plastic"
                v.Reflectance = 0
            elseif v:IsA("Decal") or v:IsA("Texture") then
                v.Transparency = 1
            elseif v:IsA("ParticleEmitter") or v:IsA("Trail") then
                v.Lifetime = NumberRange.new(0)
            elseif v:IsA("Explosion") then
                v.BlastPressure = 1
                v.BlastRadius = 1
            elseif v:IsA("Fire") or v:IsA("SpotLight") or v:IsA("Smoke") or v:IsA("Sparkles") then
                v.Enabled = false
            end
        end
        for _, e in pairs(lighting:GetChildren()) do
            if e:IsA("BlurEffect") or e:IsA("SunRaysEffect") or e:IsA("ColorCorrectionEffect") or e:IsA("BloomEffect") or e:IsA("DepthOfFieldEffect") then
                e.Enabled = false
            end
        end
        Notification("FPS Boost", "Performance optimized!", 3)
    end
end)

Window:SelectTab(1)

-- Toggle Button Functionality
local isHidden = false
ImageButton.MouseButton1Click:Connect(function()
    animateButton()
    wait(0.2)
    if isHidden then
        Window.Root.Visible = true
        isHidden = false
    else
        Window.Root.Visible = false
        isHidden = true
    end
end)

Notification("Enchanted Hub", "Patched by Copilot: Stable floating and guaranteed above attack!", 5)
