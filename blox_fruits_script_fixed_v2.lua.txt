-- ENCHANTED HUB | BLOX FRUIT Enhanced Version
-- Created by AABIS & moha with advanced features
-- Sea 1, 2, and 3 Support

local Show_Button = true
local Button_Icon = "rbxassetid://135671141026630"
local Button_Transparency = 0.1

-- Configuration Variables
getgenv().Settings = {
    -- Main Settings
    AutoFarm = false,
    FastAttack = false,
    AutoArmamentHaki = false,
    SelectedWeapon = "",
    
    -- Fruit Settings
    AutoEquipFruit = false,
    BringFruit = false,
    StoreFruit = false,
    
    -- Auto Farm Settings
    AutoFarmLevel = false,
    FarmBoss = false,
    SelectedBoss = "",
    KillSelectedBoss = false,
    
    -- Special Features
    AutoSaber = false,
    Auto700Quest = false,
    
    -- Stats Display
    ShowStats = true
}

-- UI Creation
local ScreenGui = Instance.new("ScreenGui")
local ImageButton = Instance.new("ImageButton")
local UICorner = Instance.new("UICorner")
local UIStroke = Instance.new("UIStroke")
local UIGradient = Instance.new("UIGradient")
local UIScale = Instance.new("UIScale")

ScreenGui.Name = "SpaceHubButton"
ScreenGui.Parent = game.CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

ImageButton.Parent = ScreenGui
ImageButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
ImageButton.BackgroundTransparency = Button_Transparency
ImageButton.BorderSizePixel = 0
ImageButton.Position = UDim2.new(0.05, 0, 0.1, 0)
ImageButton.Size = UDim2.new(0, 70, 0, 70)
ImageButton.Image = Button_Icon
ImageButton.Draggable = true
ImageButton.ImageTransparency = 0

UICorner.CornerRadius = UDim.new(0, 20)
UICorner.Parent = ImageButton

UIStroke.Parent = ImageButton
UIStroke.Color = Color3.fromRGB(0, 150, 255)
UIStroke.Thickness = 4
UIStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

UIGradient.Parent = ImageButton
UIGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(135, 206, 250)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(70, 130, 180))
}
UIGradient.Rotation = 45

UIScale.Parent = ImageButton
UIScale.Scale = 1

-- Animation Function
local function animateButton()
    local TweenService = game:GetService("TweenService")
    local tween1 = TweenService:Create(
        UIScale,
        TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut),
        {Scale = 0.8}
    )
    tween1:Play()
    tween1.Completed:Connect(function()
        local tween2 = TweenService:Create(
            UIScale,
            TweenInfo.new(0.1, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
            {Scale = 1.1}
        )
        tween2:Play()
        tween2.Completed:Connect(function()
            local tween3 = TweenService:Create(
                UIScale,
                TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
                {Scale = 1}
            )
            tween3:Play()
        end)
    end)
end

-- Toggle Functionality
local isHidden = false
ImageButton.MouseButton1Click:Connect(function()
    animateButton()
    wait(0.2)
    if isHidden then
        for _, gui in pairs(game.CoreGui:GetChildren()) do
            if gui.Name == "ScreenGui" and gui:FindFirstChild("Frame") then
                gui.Enabled = true
            end
        end
        if Window and Window.Root then
            Window.Root.Visible = true
        end
        isHidden = false
    else
        for _, gui in pairs(game.CoreGui:GetChildren()) do
            if gui.Name == "ScreenGui" and gui:FindFirstChild("Frame") then
                gui.Enabled = false
            end
        end
        if Window and Window.Root then
            Window.Root.Visible = false
        end
        isHidden = true
    end
end)

wait(3)

-- Load UI Library
local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local SaveManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/SaveManager.lua"))()
local InterfaceManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/InterfaceManager.lua"))()

-- Game Detection
local PlaceId = game.PlaceId
local Sea1 = PlaceId == 2753915549
local Sea2 = PlaceId == 4442272183  
local Sea3 = PlaceId == 7449423635

-- Create Window
local Window = Fluent:CreateWindow({
    Title = "ENCHANTED HUB | BLOX FRUIT Enhanced",
    SubTitle = "Created by AABIS & moha - All Seas Support",
    TabWidth = 140,
    Size = UDim2.fromOffset(650, 550),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.LeftControl
})

-- Create Tabs
local Tabs = {
    Main = Window:AddTab({ Title = "Main", Icon = "home" }),
    AutoFarm = Window:AddTab({ Title = "Auto Farm", Icon = "zap" }),
    Settings = Window:AddTab({ Title = "Settings", Icon = "settings" })
}

-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local VirtualInputManager = game:GetService("VirtualInputManager")

local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")
local RootPart = Character:WaitForChild("HumanoidRootPart")

-- Weapon Lists
local WeaponList = {
    "Combat", "Sword", "Bisento", "Katana", "Cutlass", "Dual Katana", "Iron Mace", "Triple Katana",
    "Pole (1st Form)", "Saber", "Trident", "Wando", "Shark Saw", "Shisui", "True Triple Katana",
    "Warden Sword", "Canvander", "Buddy Sword", "Twin Hooks", "Jitte", "Koko", "Rengoku",
    "Yama", "Tushita", "Dark Dagger", "Cursed Dual Katana", "Hallow Scythe", "Enma"
}

local BossList = {
    "The Gorilla King", "Bobby", "Yeti", "Mob Leader", "Vice Admiral", "Warden", "Chief Warden",
    "Swan", "Magma Admiral", "Fishman Lord", "Wysper", "Thunder God", "Cyborg", "Saber Expert",
    "Ice Admiral", "Greybeard", "Diamond", "Jeremy", "Fajita", "Don Swan", "Smoke Admiral",
    "Awakened Ice Admiral", "Tide Keeper", "Order", "Darkbeard", "Cursed Captain", "Stone",
    "Island Empress", "Kilo Admiral", "Captain Elephant", "Beautiful Pirate", "Cake Queen",
    "Longma", "Soul Reaper", "rip_indra True Form"
}

-- Utility Functions
local function GetPlayerLevel()
    return LocalPlayer.Data.Level.Value or 1
end

local function GetPlayerMoney()
    return LocalPlayer.Data.Beli.Value or 0
end

local function GetPlayerRace()
    return LocalPlayer.Data.Race.Value or "Human"
end

local function GetPlayerBounty()
    return LocalPlayer.leaderstats["Bounty/Honor"].Value or 0
end

local function GetCurrentSea()
    if Sea1 then return "Sea 1"
    elseif Sea2 then return "Sea 2"
    elseif Sea3 then return "Sea 3"
    else return "Unknown" end
end

local function EquipWeapon(weaponName)
    if not weaponName or weaponName == "" then return end
    
    local tool = LocalPlayer.Backpack:FindFirstChild(weaponName)
    if tool then
        Humanoid:EquipTool(tool)
        return true
    end
    return false
end

local function GetAllWeapons()
    local weapons = {}
    for _, item in pairs(LocalPlayer.Backpack:GetChildren()) do
        if item:IsA("Tool") then
            table.insert(weapons, item.Name)
        end
    end
    for _, item in pairs(Character:GetChildren()) do
        if item:IsA("Tool") then
            table.insert(weapons, item.Name)
        end
    end
    return weapons
end

local function EquipFruit()
    for _, item in pairs(LocalPlayer.Backpack:GetChildren()) do
        if item:IsA("Tool") and string.find(item.Name, "Fruit") then
            Humanoid:EquipTool(item)
            return true
        end
    end
    return false
end

local function TeleportTo(cframe)
    if RootPart then
        RootPart.CFrame = cframe
    end
end

local function TweenTo(cframe, speed)
    speed = speed or 300
    local distance = (RootPart.Position - cframe.Position).Magnitude
    local tweenInfo = TweenInfo.new(distance / speed, Enum.EasingStyle.Linear)
    local tween = TweenService:Create(RootPart, tweenInfo, {CFrame = cframe})
    tween:Play()
    return tween
end

-- Combat Functions
local function FastAttack()
    if not getgenv().Settings.FastAttack then return end
    
    local tool = Character:FindFirstChildOfClass("Tool")
    if tool and tool:FindFirstChild("Handle") then
        for i = 1, 5 do
            game:GetService("VirtualUser"):CaptureController()
            game:GetService("VirtualUser"):Button1Down(Vector2.new(1280, 672))
            wait(0.01)
        end
    end
end

local function UseArmamentHaki()
    if not getgenv().Settings.AutoArmamentHaki then return end
    
    local args = {
        [1] = "Buso"
    }
    ReplicatedStorage.Remotes.CommF_:InvokeServer(unpack(args))
end

-- Quest and Farming Functions
local function GetQuest(questName, questNumber)
    local args = {
        [1] = "StartQuest",
        [2] = questName,
        [3] = questNumber
    }
    ReplicatedStorage.Remotes.CommF_:InvokeServer(unpack(args))
end

local function CheckQuest()
    local level = GetPlayerLevel()
    local questData = {}
    
    if Sea1 then
        if level >= 1 and level <= 9 then
            questData = {
                Monster = "Bandit",
                QuestName = "BanditQuest1",
                QuestNumber = 1,
                QuestCFrame = CFrame.new(1060.9383544922, 16.455066680908, 1547.7841796875),
                MonsterCFrame = CFrame.new(1038.5533447266, 41.296249389648, 1576.5098876953)
            }
        elseif level >= 10 and level <= 14 then
            questData = {
                Monster = "Monkey",
                QuestName = "JungleQuest",
                QuestNumber = 1,
                QuestCFrame = CFrame.new(-1601.6553955078, 36.85213470459, 153.38809204102),
                MonsterCFrame = CFrame.new(-1402.5303955078, 89.362358093262, 6.8204474449158)
            }
        elseif level >= 15 and level <= 29 then
            questData = {
                Monster = "Gorilla",
                QuestName = "JungleQuest",
                QuestNumber = 2,
                QuestCFrame = CFrame.new(-1601.6553955078, 36.85213470459, 153.38809204102),
                MonsterCFrame = CFrame.new(-1232.3873291016, 40.462348937988, -515.39227294922)
            }
        elseif level >= 30 and level <= 39 then
            questData = {
                Monster = "Pirate",
                QuestName = "BuggyQuest1",
                QuestNumber = 1,
                QuestCFrame = CFrame.new(-1139.59717, 4.75205183, 3825.16211, -0.569968104, 3.15616096e-08, -0.821615264, 3.98718307e-08, 1, 1.06280785e-08, 0.821615264, -2.64995935e-08, -0.569968104),
                MonsterCFrame = CFrame.new(-1103.513427734375, 13.752052307128906, 3896.091064453125)
            }
        -- Add more level ranges as needed...
        end
    elseif Sea2 then
        -- Add Sea 2 quest data
        if level >= 700 and level <= 724 then
            questData = {
                Monster = "Raider",
                QuestName = "Area1Quest",
                QuestNumber = 1,
                QuestCFrame = CFrame.new(-427.72567749023, 72.99634552002, 1835.9426269531),
                MonsterCFrame = CFrame.new(68.874565124512, 93.635643005371, 2429.6752929688)
            }
        end
        -- Add more Sea 2 levels...
    elseif Sea3 then
        -- Add Sea 3 quest data
        if level >= 1500 and level <= 1524 then
            questData = {
                Monster = "Pirate Millionaire",
                QuestName = "PiratePortQuest",
                QuestNumber = 1,
                QuestCFrame = CFrame.new(-289.61752319336, 43.819011688232, 5580.0903320313),
                MonsterCFrame = CFrame.new(93.85073852539, 32.919784545898, 5603.5581054688)
            }
        end
        -- Add more Sea 3 levels...
    end
    
    return questData
end

local function AutoFarmLevel()
    if not getgenv().Settings.AutoFarmLevel then return end
    
    local questData = CheckQuest()
    if not questData.Monster then return end
    
    -- Check if we have the quest
    local questGui = LocalPlayer.PlayerGui.Main.Quest
    if not questGui.Visible then
        -- Go get quest
        TweenTo(questData.QuestCFrame)
        wait(2)
        GetQuest(questData.QuestName, questData.QuestNumber)
        wait(1)
    end
    
    -- Find and attack monsters
    for _, monster in pairs(Workspace.Enemies:GetChildren()) do
        if monster.Name == questData.Monster and monster:FindFirstChild("Humanoid") and monster.Humanoid.Health > 0 then
            repeat
                if getgenv().Settings.SelectedWeapon ~= "" then
                    EquipWeapon(getgenv().Settings.SelectedWeapon)
                end
                
                -- Position above monster
                local targetPos = monster.HumanoidRootPart.CFrame * CFrame.new(0, 20, 0)
                TeleportTo(targetPos)
                
                -- Use abilities
                UseArmamentHaki()
                FastAttack()
                
                wait(0.1)
            until not monster.Parent or monster.Humanoid.Health <= 0 or not getgenv().Settings.AutoFarmLevel
        end
    end
    
    -- If no monsters found, go to spawn area
    if #Workspace.Enemies:GetChildren() == 0 then
        TweenTo(questData.MonsterCFrame)
    end
end

local function FarmSelectedBoss()
    if not getgenv().Settings.FarmBoss or getgenv().Settings.SelectedBoss == "" then return end
    
    for _, boss in pairs(Workspace.Enemies:GetChildren()) do
        if boss.Name == getgenv().Settings.SelectedBoss and boss:FindFirstChild("Humanoid") and boss.Humanoid.Health > 0 then
            repeat
                if getgenv().Settings.SelectedWeapon ~= "" then
                    EquipWeapon(getgenv().Settings.SelectedWeapon)
                end
                
                -- Position above boss
                local targetPos = boss.HumanoidRootPart.CFrame * CFrame.new(0, 20, 0)
                TeleportTo(targetPos)
                
                -- Use abilities
                UseArmamentHaki()
                FastAttack()
                
                wait(0.1)
            until not boss.Parent or boss.Humanoid.Health <= 0 or not getgenv().Settings.FarmBoss
        end
    end
end

-- Auto Saber Function
local function AutoSaber()
    if not getgenv().Settings.AutoSaber then return end
    
    if Sea1 and LocalPlayer.Data.Level.Value >= 200 then
        -- Saber quest logic for Sea 1
        local saberQuests = {
            "Rich Son",
            "Mob Leader"
        }
        
        -- This is a simplified version - full implementation would be more complex
        for _, quest in pairs(saberQuests) do
            -- Implement saber quest steps
            wait(1)
        end
    end
end

-- Auto 700 Level Quest (Sea 1 to Sea 2)
local function Auto700Quest()
    if not getgenv().Settings.Auto700Quest then return end
    
    if Sea1 and LocalPlayer.Data.Level.Value >= 700 then
        -- Don Swan fight and Military Detective quest
        local args = {
            [1] = "DressrosaQuestProgress",
            [2] = "Detective"
        }
        ReplicatedStorage.Remotes.CommF_:InvokeServer(unpack(args))
        
        -- This would include the full quest chain implementation
        wait(1)
    end
end

-- Main Tab
local MainSection = Tabs.Main:AddSection("Combat")

local WeaponDropdown = MainSection:AddDropdown("SelectWeapon", {
    Title = "Choose Weapon",
    Values = WeaponList,
    Multi = false,
    Default = "",
})

WeaponDropdown:OnChanged(function(Value)
    getgenv().Settings.SelectedWeapon = Value
    print("Selected weapon:", Value)
end)

MainSection:AddToggle("FastAttack", {
    Title = "Fast Attack",
    Default = false
}):OnChanged(function(Value)
    getgenv().Settings.FastAttack = Value
end)

MainSection:AddToggle("AutoArmamentHaki", {
    Title = "Auto Armament Haki",
    Default = false
}):OnChanged(function(Value)
    getgenv().Settings.AutoArmamentHaki = Value
end)

-- Fruits Section
local FruitSection = Tabs.Main:AddSection("Fruits")

FruitSection:AddToggle("EquipFruit", {
    Title = "Auto Equip Fruit",
    Default = false
}):OnChanged(function(Value)
    getgenv().Settings.AutoEquipFruit = Value
end)

FruitSection:AddToggle("BringFruit", {
    Title = "Bring Fruit",
    Default = false
}):OnChanged(function(Value)
    getgenv().Settings.BringFruit = Value
end)

FruitSection:AddToggle("StoreFruit", {
    Title = "Store Fruit",
    Default = false
}):OnChanged(function(Value)
    getgenv().Settings.StoreFruit = Value
end)

-- Stats Section
local StatsSection = Tabs.Main:AddSection("Stats")

local StatsLabel = StatsSection:AddParagraph({
    Title = "Player Statistics",
    Content = "Loading stats..."
})

-- Auto Farm Tab
local AutoFarmMainSection = Tabs.AutoFarm:AddSection("Auto Farm")

AutoFarmMainSection:AddToggle("AutoFarmLevel", {
    Title = "Auto Farm Level",
    Default = false
}):OnChanged(function(Value)
    getgenv().Settings.AutoFarmLevel = Value
end)

local BossDropdown = AutoFarmMainSection:AddDropdown("SelectBoss", {
    Title = "Select Boss",
    Values = BossList,
    Multi = false,
    Default = "",
})

BossDropdown:OnChanged(function(Value)
    getgenv().Settings.SelectedBoss = Value
end)

AutoFarmMainSection:AddToggle("FarmBoss", {
    Title = "Farm Selected Boss",
    Default = false
}):OnChanged(function(Value)
    getgenv().Settings.FarmBoss = Value
end)

AutoFarmMainSection:AddToggle("KillSelectedBoss", {
    Title = "Kill Selected Boss",
    Default = false
}):OnChanged(function(Value)
    getgenv().Settings.KillSelectedBoss = Value
end)

-- Special Section
local SpecialSection = Tabs.AutoFarm:AddSection("Special")

SpecialSection:AddToggle("AutoSaber", {
    Title = "Auto Saber Quest",
    Default = false
}):OnChanged(function(Value)
    getgenv().Settings.AutoSaber = Value
end)

SpecialSection:AddToggle("Auto700Quest", {
    Title = "Auto 700 Level Quest (Sea 1â†’2)",
    Default = false
}):OnChanged(function(Value)
    getgenv().Settings.Auto700Quest = Value
end)

-- Settings Tab
local SettingsSection = Tabs.Settings:AddSection("General Settings")

SettingsSection:AddButton({
    Title = "Refresh Weapons",
    Description = "Update weapon list",
    Callback = function()
        local currentWeapons = GetAllWeapons()
        WeaponDropdown:SetValues(currentWeapons)
    end
})

SettingsSection:AddButton({
    Title = "Teleport to Spawn",
    Description = "Return to spawn point",
    Callback = function()
        local spawnPoint = Workspace:FindFirstChild("SpawnLocation")
        if spawnPoint then
            TeleportTo(spawnPoint.CFrame + Vector3.new(0, 5, 0))
        end
    end
})

-- Main Loop
spawn(function()
    while wait(0.1) do
        pcall(function()
            -- Update stats display
            local statsText = string.format(
                "Level: %d\nMoney: %s\nRace: %s\nBounty: %s\nSea: %s",
                GetPlayerLevel(),
                tostring(GetPlayerMoney()),
                GetPlayerRace(),
                tostring(GetPlayerBounty()),
                GetCurrentSea()
            )
            StatsLabel:SetDesc(statsText)
            
            -- Auto functions
            if getgenv().Settings.AutoFarmLevel then
                AutoFarmLevel()
            end
            
            if getgenv().Settings.FarmBoss then
                FarmSelectedBoss()
            end
            
            if getgenv().Settings.AutoEquipFruit then
                EquipFruit()
            end
            
            if getgenv().Settings.AutoSaber then
                AutoSaber()
            end
            
            if getgenv().Settings.Auto700Quest then
                Auto700Quest()
            end
        end)
    end
end)

-- Combat loop
spawn(function()
    while wait() do
        pcall(function()
            if getgenv().Settings.FastAttack then
                FastAttack()
            end
            
            if getgenv().Settings.AutoArmamentHaki then
                UseArmamentHaki()
            end
        end)
    end
end)

print("ENCHANTED HUB Enhanced - Loaded Successfully!")
print("Created by AABIS & moha")
print("Current Sea:", GetCurrentSea())
